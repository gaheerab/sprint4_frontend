---
layout: base 
title: Chat Room
search_exclude: true
permalink: /melodymates/chat_room.html/
---
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direct Messages Chat</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #userList {
            list-style-type: none;
            padding: 0;
        }
        #userList li {
            cursor: pointer;
            padding: 8px;
            background-color: #f0f0f0;
            margin: 5px;
        }
        #userList li:hover {
            background-color: #ddd;
        }
        #chatBox {
            display: none;
        }
        #messages {
            height: 200px;
            overflow-y: scroll;
            border: 1px solid #ddd;
            padding: 10px;
        }
        /* Modal styling */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        .modal-content {
            background-color: #ADD8E6;  /* Light blue background */
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 60%;
            text-align: center;
            color: black;  /* Black text */
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Moderator Rules Popup -->
    <div id="rulesModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModal">&times;</span>
            <h2>Moderator Rules</h2>
            <p>Welcome to the chatroom! Please adhere to the following rules:</p>
            <ul>
                <li>No offensive language or harassment.</li>
                <li>Be respectful to all participants.</li>
                <li>Do not spam messages.</li>
                <li>Follow moderators' guidance at all times.</li>
            </ul>
            <button id="acceptRules">Accept</button>
        </div>
    </div>

    <h1>Welcome to the Direct Messaging Chatroom</h1>
    <div id="login">
        <label for="username">Enter your username: </label>
        <input type="text" id="username" placeholder="Your username">
        <button onclick="login()">Log In</button>
    </div>

    <div id="userListContainer" style="display: none;">
        <h2>Choose a user to chat with:</h2>
        <ul id="userList"></ul>
    </div>

    <div id="chatBox">
        <h2>Chat with <span id="chatWith"></span></h2>
        <div id="messages"></div>
        <input type="text" id="messageInput" placeholder="Type a message...">
        <button id="sendMessage">Send</button>
    </div>

    <script>
        let currentUser = '';
        let selectedUser = '';
        let socket = null;
        let allUsers = [];

        const messages = {}; // Simulate message storage
        const badWords = ['fuck', 'shit', 'bitch', 'asshole', 'ass'];

        // Show rules modal on load
        window.onload = function () {
            const rulesModal = document.getElementById("rulesModal");
            rulesModal.style.display = "block";  // Ensure modal is shown on load

            document.getElementById("acceptRules").onclick = () => {
                rulesModal.style.display = "none"; // Hide the modal when accepted
            };
            document.getElementById("closeModal").onclick = () => {
                rulesModal.style.display = "none"; // Hide the modal when closed
            };
        };

        function login() {
            currentUser = document.getElementById("username").value.trim();
            if (currentUser) {
                if (!allUsers.includes(currentUser)) {
                    allUsers.push(currentUser); // Add new user
                }
                document.getElementById("login").style.display = "none";
                document.getElementById("userListContainer").style.display = "block";
                displayUsers();
            }
        }

        function displayUsers() {
            const userList = document.getElementById("userList");
            userList.innerHTML = '';
            allUsers.forEach(user => {
                if (user !== currentUser) {
                    const li = document.createElement("li");
                    li.textContent = user;
                    li.onclick = () => startChat(user);
                    userList.appendChild(li);
                }
            });
        }

        function startChat(user) {
            selectedUser = user;
            document.getElementById("chatWith").textContent = selectedUser;
            document.getElementById("userListContainer").style.display = "none";
            document.getElementById("chatBox").style.display = "block";
            displayMessages();
        }

        function displayMessages() {
            const messagesDiv = document.getElementById("messages");
            messagesDiv.innerHTML = '';
            const chatKey = [currentUser, selectedUser].sort().join('-');
            if (messages[chatKey]) {
                messages[chatKey].forEach(msg => {
                    const p = document.createElement("p");
                    p.textContent = msg;
                    messagesDiv.appendChild(p);
                });
            }
        }

        function censorMessage(message) {
            badWords.forEach(badWord => {
                const regex = new RegExp(badWord, 'gi');
                message = message.replace(regex, '****');
            });
            return message;
        }

        document.getElementById("sendMessage").onclick = function () {
            let message = document.getElementById("messageInput").value;
            if (message) {
                message = censorMessage(message);
                const chatKey = [currentUser, selectedUser].sort().join('-');
                if (!messages[chatKey]) {
                    messages[chatKey] = [];
                }
                messages[chatKey].push(`${currentUser}: ${message}`);
                displayMessages();
                document.getElementById("messageInput").value = '';
            }
        };
    </script>
</body>
</html>
